<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Wordlane Tech Admin Teams - Manage and view all teams.">
    <meta name="keywords" content="Admin Teams, HR, Teams, Collaboration, Wordlane Tech">
    <meta name="author" content="Wordlane Tech">
    <title>Wordlane Tech - Admin Teams</title>

    <!-- Google Fonts: Roboto for professional typography -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Tailwind CSS CDN -->

    <link rel="stylesheet" href="admin.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
       
        @media (max-width: 768px) {
            .header-gradient { padding: 1rem; }
            .header-gradient h1 { font-size: 1.75rem; }
            .header-gradient img { width: 35px; height: 35px; }
            .nav-list { flex-direction: column; align-items: center; gap: 0.25rem; padding: 0.5rem 0; }
            .nav-item { width: 100%; }
            .nav-link { justify-content: center; padding: 0.75rem 1rem; border-radius: 0.375rem; }
            .page-title { font-size: 2.5rem; }
            .profile-dropdown { right: 1rem; min-width: unset; width: calc(100% - 2rem); }
            .profile-container { padding: 0.5rem 1rem; gap: 0.75rem; }
            .profile-picture { width: 40px; height: 40px; }
            .profile-name { font-size: 0.85rem; }
            .profile-role { font-size: 0.7rem; }
        }
        .team-card {
            background: #ffffff;
            border-radius: 1.5rem;
            border: 1px solid #e2e7ed;
            box-shadow: 0 2px 8px 0 rgba(31, 68, 106, 0.06);
            transition: all 0.3s ease;
        }
        .team-card:hover {
            box-shadow: 0 8px 24px 0 rgba(31, 68, 106, 0.12);
            transform: translateY(-2px);
            border-color: #b6cbe1;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(31, 68, 106, 0.7);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 50;
        }
        .modal-content {
            background: #ffffff;
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 600px;
            position: relative;
            transform: scale(0.95);
            opacity: 0;
            transition: all 0.3s ease-in-out;
            z-index: 51;
        }
        .modal.show .modal-content {
            transform: scale(1);
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- Header Section -->
    <header class="header-gradient p-3 shadow-lg flex flex-col sm:flex-row items-center justify-between sticky top-0 z-10 mt-3 mr-5 ml-5 mb-3" style="border-radius: 25px;">
        <!-- Left side: Logo and Company Name (clickable to dashboard) -->
        <a href="admin_dashboard.html" class="flex items-center mb-2 sm:mb-0 text-gray-800 no-underline hover:opacity-80 transition duration-200">
            <img src="../images/WLT_LOGO2.jpg" alt="Wordlane Tech Logo" class="mr-2 w-8 h-8" style="object-fit: cover; border-radius: 50px; border: 2px solid #1F446A;">
            <h1 class="text-lg font-bold tracking-wide" style="color: #1F446A;">WordLane Tech</h1>
        </a>
        <!-- Center: Navigation Links -->
        <nav class="bg-gray-100/50 p-1.5 rounded-full shadow-inner mb-2 md:mb-0" style="box-shadow:inset 1px 1px 6px 1px #57525224; padding: 8px 16px">
            <ul class="flex flex-wrap justify-center md:flex-nowrap list-none p-0 m-0 text-xs" style="gap: 4px;">
                <li><a href="admin_dashboard.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors "><i class="fas fa-home mr-1.5" style="font-size: 0.95em;"></i> Dashboard</a></li>
                <li><a href="admin_employees.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-users mr-1.5" style="font-size: 0.95em;"></i> Employees</a></li>
                <li><a href="admin_projects.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-briefcase mr-1.5" style="font-size: 0.95em;"></i> Projects</a></li>
                <li><a href="admin_tasks.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-tasks mr-1.5" style="font-size: 0.95em;"></i> Tasks</a></li>
                <li><a href="admin_departments.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-building mr-1.5" style="font-size: 0.95em;"></i> Departments</a></li>
                <li><a href="admin_teams.html" class="active nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-user-friends mr-1.5" style="font-size: 0.95em;"></i> Teams</a></li>
                <li><a href="admin_attendance.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-clipboard-check mr-1.5" style="font-size: 0.95em;"></i> Attendance</a></li>
                <li><a href="admin_leaves.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-calendar-alt mr-1.5" style="font-size: 0.95em;"></i> Leaves</a></li>
                <li><a href="admin_documents.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-file-alt mr-1.5" style="font-size: 0.95em;"></i> Documents</a></li>
                <li><a href="admin_reports.html" class="nav-link flex items-center px-2 py-1 rounded-full text-gray-700 hover:bg-gray-200 transition-colors"><i class="fas fa-chart-bar mr-1.5" style="font-size: 0.95em;"></i> Reports</a></li>
            </ul>
        </nav>
        <!-- Right side: AMAZING Profile Capsule with dropdown -->
        <div class="relative">
            <button id="profileButton" class="profile-container focus:outline-none" aria-label="User Profile Menu">
                <div class="profile-picture" style="width: 28px; height: 28px;">
                    <img src="https://placehold.co/28x28/CCCCCC/FFFFFF?text=AD" alt="Admin Profile" />
                </div>
                <div class="profile-info">
                    <p class="profile-name text-xs">Admin</p>
                </div>
            </button>

            <!-- Enhanced Profile Dropdown Menu -->
            <div id="profileDropdown" class="profile-dropdown">
                <a href="hr_profile.html" class="flex items-center">
                    <i class="fas fa-user" aria-hidden="true"></i>
                    My Profile
                </a>
                <a href="../login.html" class="flex items-center">
                    <i class="fas fa-sign-out-alt" aria-hidden="true"></i>
                    Log Out
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content Area - Employee Teams -->
    <main class="flex-grow p-8 bg-gray-50">
        <div class="max-w-7xl mx-auto">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8">
                <h2 class="text-3xl font-extrabold text-gray-900 mb-2">Our Teams</h2>
            </div>
            <!-- Teams Grid -->
            <div id="teams-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Team cards will be dynamically inserted here -->
            </div>
        </div>
    </main>

    <!-- Modal for Team Details -->
    <div id="teamDetailModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 id="modal-team-name" class="text-2xl font-bold text-gray-900"></h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>
            <div class="space-y-4">
                <p class="text-sm text-gray-600" id="modal-team-description"></p>
                <div class="flex items-center text-gray-700">
                    <i class="fas fa-crown mr-2 text-yellow-500"></i>
                    <p class="text-lg font-semibold">Team Lead: <span id="modal-team-lead" class="font-normal text-gray-600"></span></p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-2 text-gray-800">Members (<span id="modal-member-count"></span>)</h4>
                    <div id="modal-member-list" class="space-y-2 max-h-60 overflow-y-auto pr-4">
                        <!-- Member list will be dynamically inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white p-4 text-center mt-auto rounded-t-lg">
        <p class="text-sm">&copy; 2025 Wordlane Tech. All rights reserved.</p>
    </footer>

   <script>
document.addEventListener('DOMContentLoaded', () => {
    let teamsData = [];

    // Fetch teams from backend
    async function fetchTeams() {
        try {
            const res = await fetch('http://localhost:3001/api/teams', {
                method: 'GET',
                headers: { 'Accept': 'application/json' }
            });
            const data = await res.json();
            console.log('Teams fetched:', data);

            // Ensure members array exists
            teamsData = data.map(team => ({
                ...team,
                members: Array.isArray(team.members) ? team.members : []
            }));

            populateTeamsGrid();
        } catch (err) {
            console.error('Error fetching teams:', err);
        }
    }

    // Profile dropdown toggle
    function setupProfileDropdown() {
        const profileButton = document.getElementById('profileButton');
        const profileDropdown = document.getElementById('profileDropdown');

        if (!profileButton || !profileDropdown) return;

        profileButton.addEventListener('click', (e) => {
            e.stopPropagation();
            profileDropdown.classList.toggle('show');
        });

        document.addEventListener('click', () => {
            profileDropdown.classList.remove('show');
        });
    }

    // Create team card HTML
    function createTeamCard(team) {
        const displayedMembers = team.members.slice(0, 3);
        const remainingMembersCount = Math.max(team.members.length - 3, 0);

        return `
            <div class="team-card p-6 flex flex-col justify-between">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-users text-xl text-gray-600"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900">${team.name}</h3>
                    </div>
                    <p class="text-gray-600 mb-4">${team.description || ''}</p>
                    <div class="text-sm text-gray-500 flex justify-between items-center mb-6">
                        <span class="flex items-center">
                            <i class="fas fa-crown text-yellow-500 mr-2"></i>Lead: ${team.leader || 'N/A'}
                        </span>
                        <span class="flex items-center">
                            <i class="fas fa-users text-gray-400 mr-2"></i>${team.memberCount} Members
                        </span>
                    </div>
                </div>
                <div class="flex items-center justify-between mt-auto">
                    <div class="flex -space-x-2 overflow-hidden">
                        ${displayedMembers.map(m => `
                            <img class="inline-block h-8 w-8 rounded-full ring-2 ring-white" 
                                 src="${m.avatar || 'https://via.placeholder.com/32'}" 
                                 alt="${m.name || 'Member'}">
                        `).join('')}
                        ${remainingMembersCount > 0 ? `
                            <span class="flex items-center justify-center h-8 w-8 rounded-full bg-gray-300 text-xs font-medium text-gray-700 ring-2 ring-white">
                                +${remainingMembersCount}
                            </span>
                        ` : ''}
                    </div>
                    <button class="view-details-btn bg-[#1F446A] text-white text-sm font-semibold py-2 px-4 rounded-full shadow-md hover:bg-[#153452] transition-colors" data-team-id="${team.id}">
                        View Details
                    </button>
                </div>
            </div>
        `;
    }

    // Render all team cards
    function populateTeamsGrid() {
        const teamsGrid = document.getElementById('teams-grid');
        teamsGrid.innerHTML = teamsData.length
            ? teamsData.map(createTeamCard).join('')
            : '<p class="text-center text-gray-500 text-lg col-span-full">No teams found.</p>';
    }

    // --- Modal Logic ---
    const teamDetailModal = document.getElementById('teamDetailModal');
    const closeModalBtn = document.getElementById('closeModalBtn');

    document.getElementById('teams-grid').addEventListener('click', (e) => {
        if (e.target.classList.contains('view-details-btn')) {
            const teamId = e.target.dataset.teamId;
            const team = teamsData.find(t => String(t.id) === String(teamId));
            if (team) openTeamDetailModal(team);
        }
    });

    function openTeamDetailModal(team) {
        document.getElementById('modal-team-name').textContent = team.name;
        document.getElementById('modal-team-description').textContent = team.description || '';
        document.getElementById('modal-team-lead').textContent = team.leader || 'N/A';
        document.getElementById('modal-member-count').textContent = team.members.length;

        document.getElementById('modal-member-list').innerHTML = team.members.map(m => `
            <div class="flex items-center space-x-3 p-2 bg-gray-50 rounded-lg">
                <img class="h-9 w-9 rounded-full" src="${m.avatar || 'https://via.placeholder.com/36'}" alt="${m.name || 'Member'}">
                <div>
                    <p class="text-sm font-semibold text-gray-800">${m.name || ''}</p>
                    <p class="text-xs text-gray-500">${m.role || ''}</p>
                </div>
            </div>
        `).join('');

        teamDetailModal.style.display = 'flex';
        setTimeout(() => teamDetailModal.classList.add('show'), 10);
    }

    function closeModal() {
        teamDetailModal.classList.remove('show');
        setTimeout(() => { teamDetailModal.style.display = 'none'; }, 300);
    }

    closeModalBtn.addEventListener('click', closeModal);
    window.addEventListener('click', (e) => { if (e.target === teamDetailModal) closeModal(); });

    // Init
    setupProfileDropdown();
    fetchTeams();
});
</script>
</body>
</html> 